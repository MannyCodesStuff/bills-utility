(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4311:(e,s,l)=>{Promise.resolve().then(l.bind(l,8026))},8026:(e,s,l)=>{"use strict";l.d(s,{BillManager2:()=>ed});var t=l(3365),a=l(1521),r=l(1252),n=l(5850),i=l(2074),o=l(4715),c=l(4693),d=l(2812),m=l(7027),u=l(1076),h=l(9915),x=l(127),f=l(4191),p=l(6655),g=l(1114);let v=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",l),...a})});v.displayName="Card",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",l),...a})}).displayName="CardHeader",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",l),...a})}).displayName="CardTitle",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("text-sm text-muted-foreground",l),...a})}).displayName="CardDescription",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("p-6 pt-0",l),...a})}).displayName="CardContent",a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,g.cn)("flex items-center p-6 pt-0",l),...a})}).displayName="CardFooter";var j=l(8699),N=l(4125),y=l(243);let w=y.bL,b=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(y.B8,{ref:s,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",l),...a})});b.displayName=y.B8.displayName;let P=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(y.l9,{ref:s,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",l),...a})});P.displayName=y.l9.displayName;let S=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(y.UC,{ref:s,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l),...a})});S.displayName=y.UC.displayName;let D=e=>{let{directory:s,directoryExists:l,onRefresh:a}=e,{setDirectoryPaths:r,activeTab:n,directoryPaths:i}=(0,m.P)(),o=async()=>{try{if(window.ipc){let e=await window.ipc.selectDirectory();e&&(r({...i,[n]:e}),a(n))}else{let e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.onchange=async e=>{let s=e.target.files;if(s&&s.length>0){let e=s[0].path.split("\\").slice(0,-1).join("\\");r({...i,[n]:e}),a(n)}},e.click()}}catch(e){d.oR.error(e instanceof Error?e.message:"Failed to select directory")}};return(console.log("directory",s),console.log("directoryExists",l),console.log(i),l)?(0,t.jsx)("p",{children:"Folder has no PDF files to display."}):(0,t.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,t.jsxs)("p",{children:['Directory: "',s,'" ',(0,t.jsx)("br",{}),"was not found."]}),(0,t.jsx)(N.$,{onClick:o,children:"Select Directory"})]})};function C(e){var s,l;let{loading:r,filterQuery:n,setFilterQuery:i,onRefresh:o,onPdfLoaded:c}=e,{date:d,activeTab:u,setActiveTab:y,directoryExists:C,directoryPaths:F,selectedPdf:T,setSelectedPdf:E,pdfFiles:I,setPdfFiles:R,deletingPdf:A}=(0,m.P)(),{pdfDisplay:L,loadPdf:z,clearPdf:M}=function(){let[e,s]=(0,a.useState)({url:null,fileName:null,isLoading:!1,error:null,cleanup:null}),l=async l=>{e.cleanup&&e.cleanup(),s(e=>({...e,isLoading:!0,error:null,url:null}));try{let{url:e,fileName:t,cleanup:a}=await (0,g.k)(l);return s({url:e,fileName:t,isLoading:!1,error:null,cleanup:a}),console.log("PDF loaded successfully: ".concat(t)),{url:e,fileName:t}}catch(l){let e=l instanceof Error?l.message:"Failed to load PDF";throw s(s=>({...s,isLoading:!1,error:e})),console.error("Failed to load PDF:",l),l}};return(0,a.useEffect)(()=>()=>{e.cleanup&&e.cleanup()},[e.cleanup]),{pdfDisplay:e,loadPdf:l,clearPdf:()=>{e.cleanup&&e.cleanup(),s({url:null,fileName:null,isLoading:!1,error:null,cleanup:null})}}}(),O=async e=>{console.log("CLICKED PDF: ",e),E(e);try{await z(e.originalPath)}catch(e){console.error("Failed to load PDF for display:",e)}};(0,a.useEffect)(()=>{!T&&L.url&&M()},[T,L.url,M]);let k=()=>({isLoading:L.isLoading,url:L.url,fileName:L.fileName,error:L.error,hasActivePdf:!!L.url});(0,a.useEffect)(()=>{L.url&&(console.log("PDF blob URL ready:",L.url),console.log("Current PDF state:",k()),null==c||c(k()))},[L.url,c]);let V=I.filter(e=>(e.originalPath.split("\\").pop()||"").toLowerCase().includes(n.toLowerCase())),B=(e,s,l)=>{var a;return(0,t.jsx)("div",{className:"p-2 px-3",children:r?(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)(h.A,{className:"text-primary size-6 animate-spin"})}):0===e.length?(0,t.jsx)("div",{className:"text-muted-foreground px-3 py-8 text-center text-sm",children:n.length>0?"No matching files found":(0,t.jsx)(D,{directory:l,directoryExists:null!==(a=null==C?void 0:C[u])&&void 0!==a&&a,onRefresh:o})}):(0,t.jsx)("ul",{className:"space-y-1.5",children:e.map((e,s)=>{let l=e.originalPath.split("\\").pop()||"";return(0,t.jsx)("li",{className:"group relative cursor-pointer",children:(0,t.jsxs)("div",{className:(0,N.r)({className:"h-auto w-full justify-start px-2 py-1.5",variant:(null==T?void 0:T.originalPath)===e.originalPath?"default":"ghost"}),onClick:()=>O(e),children:[(0,t.jsx)(x.A,{className:"mr-2 size-4"}),A===e.originalPath?(0,t.jsxs)("span",{className:"flex-1 truncate",children:["Deleting..."," ",(0,t.jsx)(f.A,{className:"ml-2 size-4 animate-spin"})]}):L.isLoading&&(null==T?void 0:T.originalPath)===e.originalPath?(0,t.jsxs)("span",{className:"flex flex-1 items-center truncate",children:["Loading PDF..."," ",(0,t.jsx)(f.A,{className:"ml-2 size-4 animate-spin"})]}):(0,t.jsx)("span",{className:"flex-1 truncate",children:l}),L.error&&(null==T?void 0:T.originalPath)===e.originalPath&&(0,t.jsx)("span",{className:"ml-2 text-xs text-red-500",children:"Failed"})]})},s)})})})},U=(e,s,l)=>(0,t.jsxs)("div",{className:"border-b p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text font-semibold",children:e}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(N.$,{variant:"ghost",size:"icon",onClick:()=>o(l),disabled:r,className:"size-8",children:(0,t.jsx)(h.A,{className:"size-4 ".concat(r?"animate-spin":"")})})})]}),(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:s||"No directory selected"}),(0,t.jsxs)("div",{className:"relative mt-3",children:[(0,t.jsx)(p.A,{className:"text-muted-foreground absolute left-2 top-2.5 size-4"}),(0,t.jsx)(j.p,{placeholder:"Search ".concat(e.toLowerCase(),"..."),className:"pl-8",value:n,onChange:e=>i(e.target.value)})]})]});return(0,t.jsx)(v,{className:"flex h-[calc(100vh-64px-24px)] max-h-full flex-col",children:(0,t.jsxs)(w,{defaultValue:"scans",value:u,className:"flex h-full flex-col",onValueChange:e=>{R([]),y(e)},children:[(0,t.jsxs)(b,{className:"mx-auto mt-2 w-[95%]",children:[(0,t.jsx)(P,{value:"scans",className:"w-full",children:"Scans"}),(0,t.jsx)(P,{value:"bills",className:"w-full",children:"Bills"}),(0,t.jsx)(P,{value:"non-invoice",className:"w-full",children:"Non-Invoice"})]}),"scans"===u&&(0,t.jsxs)(S,{value:"scans",className:"flex flex-1 flex-col overflow-hidden",children:[U("Scans",F.scans,"scans"),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:B(V,"No scans found in this directory",F.scans)})]}),"bills"===u&&(0,t.jsxs)(S,{value:"bills",className:"flex flex-1 flex-col overflow-hidden",children:[U("".concat(null!==(s=null==d?void 0:d.toLocaleDateString())&&void 0!==s?s:""," Bills"),F.bills,"bills"),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:B(V,"No bills found in this directory",F.bills)})]}),"non-invoice"===u&&(0,t.jsxs)(S,{value:"non-invoice",className:"flex flex-1 flex-col overflow-hidden",children:[U("".concat(null!==(l=null==d?void 0:d.toLocaleDateString())&&void 0!==l?l:""," Non-Invoice Documents"),F["non-invoice"],"non-invoice"),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto",children:B(V,"No non-invoice documents found in this directory",F["non-invoice"])})]})]})})}var F=l(5278),T=l(6871),E=l(8848);function I(){let{selectedPdf:e,isActionLoading:s,pdfFiles:l,setSelectedPdf:r}=(0,m.P)(),[n,i]=(0,a.useState)({url:null,fileName:null,isLoading:!1,error:null,cleanup:null});if((0,a.useEffect)(()=>{(async()=>{if(n.cleanup&&n.cleanup(),!e){i({url:null,fileName:null,isLoading:!1,error:null,cleanup:null});return}if(s){console.log("PDF loading skipped - action in progress, keeping current PDF visible"),i(e=>({...e,isLoading:!1,error:null}));return}i(e=>({...e,isLoading:!0,error:null}));try{let{url:s,fileName:l,cleanup:t}=await (0,g.k)(e.originalPath);i({url:s,fileName:l,isLoading:!1,error:null,cleanup:t}),console.log("PDF viewer loaded: ".concat(l))}catch(l){let e=l instanceof Error?l.message:"Failed to load PDF";s?(console.log("PDF load error during action (expected):",e),i(e=>({...e,isLoading:!1,error:null}))):(i(s=>({...s,isLoading:!1,error:e})),console.error("PDF viewer error:",l))}})()},[e,s]),(0,a.useEffect)(()=>()=>{n.cleanup&&n.cleanup()},[n.cleanup]),!e)return(0,t.jsx)(v,{className:"flex h-[calc(100vh-64px-52px-24px)] flex-col lg:h-[calc(100vh-64px-24px)]",children:(0,t.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,t.jsx)(x.A,{className:"text-muted-foreground/40 size-16"}),(0,t.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No Document Selected"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:"Select a document from the sidebar to preview it"})]})});let o=l.findIndex(s=>s.originalPath===e.originalPath);return(0,t.jsxs)(v,{className:"flex h-[calc(100vh-64px-52px-24px)] flex-col lg:h-[calc(100vh-64px-24px)]",children:[(0,t.jsxs)("div",{className:"flex h-[70px] items-center justify-between border-b p-3",children:[(0,t.jsxs)("div",{className:"overflow-hidden",children:[(0,t.jsx)("h2",{className:"truncate font-semibold",children:n.fileName||e.originalPath.split("\\").pop()}),(0,t.jsx)("p",{className:"text-muted-foreground truncate text-xs",children:e.originalPath})]}),(0,t.jsxs)("div",{className:"flex flex-nowrap items-center gap-3",children:[(0,t.jsx)(N.$,{variant:"outline",size:"icon",onClick:()=>{let e=o-1;e>=0&&r(l[e])},disabled:0===o,className:"size-8",children:(0,t.jsx)(F.A,{className:"size-4"})}),(0,t.jsxs)("span",{className:"text-muted-foreground whitespace-nowrap text-sm",children:[o+1," / ",l.length]}),(0,t.jsx)(N.$,{variant:"outline",size:"icon",onClick:()=>{let e=o+1;e<l.length&&r(l[e])},disabled:o===l.length-1,className:"size-8",children:(0,t.jsx)(T.A,{className:"size-4"})})]})]}),(0,t.jsx)("div",{className:"h-[calc(100vh-64px-52px-24px-70px)] lg:h-[calc(100vh-64px-24px-70px)]",children:n.isLoading?(0,t.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,t.jsx)(f.A,{className:"text-primary size-8 animate-spin"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-4 text-sm",children:"Loading PDF..."})]}):n.error&&!s?(0,t.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,t.jsx)(E.A,{className:"size-16 text-red-500/40"}),(0,t.jsx)("h3",{className:"mt-4 text-lg font-medium text-red-600",children:"Failed to Load PDF"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:n.error}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1 text-center text-xs",children:"Please try selecting the document again"})]}):n.url?(0,t.jsx)("div",{className:"h-full p-3",children:(0,t.jsx)("div",{className:"h-full w-full",children:(0,t.jsxs)("object",{data:n.url,type:"application/pdf",className:"size-full rounded-lg border","aria-label":"PDF viewer for ".concat(n.fileName),children:[(0,t.jsx)("embed",{src:n.url,type:"application/pdf",className:"size-full rounded-lg"}),(0,t.jsxs)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:[(0,t.jsx)(x.A,{className:"text-muted-foreground/40 size-16"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-4 text-sm",children:"Your browser doesn't support PDF viewing."}),(0,t.jsx)("a",{href:n.url,download:n.fileName,className:"text-primary mt-2 text-sm underline hover:no-underline",children:"Download PDF instead"})]})]})})}):(0,t.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,t.jsx)(x.A,{className:"text-muted-foreground/40 size-16"}),(0,t.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No PDF Content"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:"Unable to load PDF content"})]})})]})}var R=l(7761),A=l(6),L=l(6805),z=l(3900),M=l(5114),O=l(3689),k=l(5958),V=l(4172);function B(e){let{vendors:s,selectedVendor:l,setSelectedVendor:r,disabled:n=!1,searchPlaceholder:i="Search vendor...",selectText:o="Select vendor...",categoryLabel:c="Vendor"}=e,[d,m]=a.useState(!1),u=a.useMemo(()=>{let e=s.find(e=>e.id===l);return e?e.name:""},[s,l]);return(0,t.jsxs)(V.AM,{open:d,onOpenChange:m,children:[(0,t.jsx)(V.Wv,{asChild:!0,children:(0,t.jsxs)(N.$,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between truncate max-lg:text-xs max-lg:placeholder:text-xs",disabled:n,children:[l?u:o,(0,t.jsx)(M.A,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(V.hl,{className:"w-full p-0",children:(0,t.jsxs)(k.uB,{children:[(0,t.jsx)(k.G7,{placeholder:i}),(0,t.jsxs)(k.oI,{children:[(0,t.jsx)(k.xL,{children:"No vendor found."}),(0,t.jsx)(k.L$,{heading:c,children:s.map(e=>(0,t.jsxs)(k.h_,{value:e.name,onSelect:e=>{console.log({value:e});let l=s.find(s=>s.name===e);r(l?l.id:""),m(!1)},children:[(0,t.jsx)(O.A,{className:(0,g.cn)("mr-2 h-4 w-4",l===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})}var U=l(6003);let _=e=>{let{message:s}=e;return s?(0,t.jsxs)("div",{className:"bg-destructive/20 text-destructive flex items-center justify-center gap-x-2 rounded-md p-3 text-sm dark:text-red-400",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 md:h-6 md:w-6"}),(0,t.jsx)("p",{children:s})]}):null};var $=l(9816),J=l(9813),Y=l(1538),Z=l(3798),K=l(123),W=l(2991);let H=(0,a.forwardRef)((e,s)=>{let{value:l,onChange:a,disabled:r,placeholder:n="Enter amount"}=e;return(0,t.jsx)(Y.oz,{value:l||0,onChange:a,isDisabled:r,formatOptions:{style:"currency",currency:"USD",currencySign:"accounting"},children:(0,t.jsxs)(Z.Y,{className:"border-input data-focus-within:border-ring data-focus-within:ring-ring/50 data-focus-within:has-aria-invalid:ring-destructive/20 dark:data-focus-within:has-aria-invalid:ring-destructive/40 data-focus-within:has-aria-invalid:border-destructive shadow-xs data-disabled:opacity-50 data-focus-within:ring-[3px] relative inline-flex h-9 w-full items-center overflow-hidden whitespace-nowrap rounded-md border text-sm outline-none transition-[color,box-shadow]",children:[(0,t.jsx)(K.p,{ref:s,placeholder:n,className:"bg-background text-foreground flex-1 px-3 py-2 tabular-nums"}),(0,t.jsxs)("div",{className:"flex h-[calc(100%+2px)] flex-col",children:[(0,t.jsx)(W.$,{slot:"increment",className:"border-input bg-background text-muted-foreground/80 hover:bg-accent hover:text-foreground -me-px flex h-1/2 w-6 flex-1 items-center justify-center border text-sm transition-[color,box-shadow] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",children:(0,t.jsx)($.A,{size:12,"aria-hidden":"true"})}),(0,t.jsx)(W.$,{slot:"decrement",className:"border-input bg-background text-muted-foreground/80 hover:bg-accent hover:text-foreground -me-px -mt-px flex h-1/2 w-6 flex-1 items-center justify-center border text-sm transition-[color,box-shadow] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",children:(0,t.jsx)(J.A,{size:12,"aria-hidden":"true"})})]})]})})});function G(e){let{value:s,onChange:l,options:r,disabled:n=!1,placeholder:i="Select or type invoice number...",searchPlaceholder:o="Search or type...",groupLabel:c="Electronic Invoice Numbers"}=e,[d,m]=a.useState(!1),[u,h]=a.useState(""),x=a.useMemo(()=>Array.from(new Set(r.filter(Boolean))).sort(),[r]),f=a.useMemo(()=>!!x.find(e=>e.toLowerCase()===u.trim().toLowerCase()),[x,u]),p=e=>{l(e),m(!1),h("")};return(0,t.jsxs)(V.AM,{open:d,onOpenChange:e=>{!e&&u.trim()&&!f&&(l(u.trim()),h("")),m(e)},children:[(0,t.jsx)(V.Wv,{asChild:!0,children:(0,t.jsxs)(N.$,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between truncate max-lg:text-xs max-lg:placeholder:text-xs",disabled:n,children:[s||i,(0,t.jsx)(M.A,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(V.hl,{className:"w-full p-0",children:(0,t.jsxs)(k.uB,{shouldFilter:!1,children:[(0,t.jsx)(k.G7,{value:u,onValueChange:h,placeholder:o,onKeyDown:e=>{"Enter"===e.key&&u.trim()&&!f&&(e.preventDefault(),p(u.trim()))}}),(0,t.jsxs)(k.oI,{children:[u.trim()&&!f&&(0,t.jsx)(k.L$,{heading:"Custom",children:(0,t.jsxs)(k.h_,{value:u,onSelect:()=>p(u.trim()),children:["Use “",u.trim(),"”"]})}),(0,t.jsxs)(k.xL,{children:["No electronic invoice found.",(0,t.jsx)("br",{}),"Type invoice number"]}),(0,t.jsx)(k.L$,{heading:c,children:x.filter(e=>!u||e.toLowerCase().includes(u.trim().toLowerCase())).map(e=>(0,t.jsxs)(k.h_,{value:e,onSelect:()=>p(e),children:[(0,t.jsx)(O.A,{className:(0,g.cn)("mr-2 h-4 w-4",s===e?"opacity-100":"opacity-0")}),e]},e))})]})]})})]})}function Q(e){let{form:s,vendors:l,vendorsLoading:r,selectedPdf:n,onSubmit:i,documentType:o,errorMessage:c}=e,{isActionLoading:d,date:u,storeId:x}=(0,m.P)(),[f,p]=(0,a.useState)([]),g=("production-order"===o?l.filter(e=>"4181"===e.id||"4183"===e.id):l).map(e=>"CONSOLID_SUPER"===e.id?{...e,name:"CSS - KoolTemp"}:e),v=async e=>{if(window.ipc&&x&&u){let s=await window.ipc.getASNs(x,"CONSOLID_SUPER"===e?"K001":e,u);(null==s?void 0:s.success)?p(s.data||[]):p([])}},j=a.useMemo(()=>Array.from(new Set((null!=f?f:[]).map(e=>{var s;return null!==(s=null==e?void 0:e.F91)&&void 0!==s?s:""}).filter(Boolean).map(String)||[])).sort(),[f]);return(0,t.jsx)(L.lV,{...s,children:(0,t.jsxs)("form",{onSubmit:s.handleSubmit(i),className:"space-y-4",children:[(0,t.jsx)(L.zB,{control:s.control,name:"vendorId",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Vendor"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(B,{vendors:g,selectedVendor:s.value,setSelectedVendor:e=>{s.onChange(e),v(e)},disabled:!n||r||d})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"invoiceNumber",render:e=>{let{field:l}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Invoice Number"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(G,{value:l.value||"",onChange:e=>{l.onChange(e);let t=f.find(s=>String(null==s?void 0:s.F91)===String(e));if((null==t?void 0:t.Net)!=null){let e=function(e){if(null==e)return 0;let s=String(e).trim(),l=/^\(.*\)$/.test(s),t=parseFloat((s=s.replace(/[^\d.-]/g,""))||"0");return Number.isFinite(t)||(t=0),l&&t>0&&(t=-t),t}(t.Net);s.setValue("invoiceTotal",e,{shouldDirty:!0,shouldValidate:!0})}},options:j,disabled:!n||d,placeholder:"Select or type invoice number...",searchPlaceholder:"Search or type...",groupLabel:"Electronic Invoice Numbers"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"invoiceDate",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Invoice Date"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(z.l,{date:s.value,handleDateChange:s.onChange,disabled:!n||d})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"invoiceTotal",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Invoice Total"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(H,{value:s.value||0,onChange:s.onChange,disabled:!n||d,placeholder:"Enter invoice total"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(_,{message:c}),(0,t.jsx)(N.$,{type:"submit",className:"w-full",disabled:d||!n,children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 size-4"}),"Upload Invoice"]})})]})})}function q(e){let{form:s,documentType:l,selectedPdf:a,onSubmit:r,errorMessage:n}=e,{isActionLoading:i}=(0,m.P)();return(0,t.jsx)(L.lV,{...s,children:(0,t.jsxs)("form",{onSubmit:s.handleSubmit(r),className:"space-y-4",children:[(0,t.jsx)(L.zB,{control:s.control,name:"date",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Document Date"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(z.l,{date:s.value,handleDateChange:s.onChange,disabled:!a||i})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(_,{message:n}),(0,t.jsx)(N.$,{type:"submit",className:"w-full",disabled:i||!a,children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 size-4"}),"Upload ",l.charAt(0).toUpperCase()+l.slice(1).replace("-"," ")]})})]})})}H.displayName="MoneyInput";var X=l(7807);function ee(e){let{form:s,selectedPdf:l,onSubmit:a}=e,{isActionLoading:r}=(0,m.P)();return(0,t.jsx)(L.lV,{...s,children:(0,t.jsxs)("form",{className:"space-y-4",children:[(0,t.jsx)(L.zB,{control:s.control,name:"newFileName",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"New File Name"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(j.p,{...s,disabled:!l||r,placeholder:"Enter new file name"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"date",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsxs)(L.lR,{children:["Document Date"," ",(0,t.jsx)("span",{className:"text-muted-foreground",children:"(optional)"})]}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(z.l,{date:s.value,handleDateChange:s.onChange,disabled:!l||r})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(N.$,{type:"button",onClick:()=>s.handleSubmit(e=>a(e,"rename"))(),className:"w-full",disabled:r||!l,children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.A,{className:"mr-2 size-4"}),"Rename File"]})})]})})}function es(e){let{form:s,vendors:l,selectedPdf:a,onSubmit:r,errorMessage:n}=e,{isActionLoading:i}=(0,m.P)();return(0,t.jsx)(L.lV,{...s,children:(0,t.jsxs)("form",{onSubmit:s.handleSubmit(r),className:"space-y-4",children:[(0,t.jsx)(L.zB,{control:s.control,name:"vendorId",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Vendor"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(B,{vendors:l,selectedVendor:s.value,setSelectedVendor:s.onChange,disabled:!a||i})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"creditMemoNumber",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Credit Memo Number"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(j.p,{...s,placeholder:"Enter credit memo number",disabled:!a||i})}),(0,t.jsx)(L.Rr,{children:"Please provide the credit memo number if available."}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"creditMemoDate",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Credit Memo Date"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(z.l,{date:s.value,handleDateChange:s.onChange,disabled:!a||i})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(_,{message:n}),(0,t.jsx)(N.$,{type:"submit",className:"w-full",disabled:i||!a,children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 size-4"}),"Upload Credit Memo"]})})]})})}function el(e){let{form:s,vendors:l,vendorsLoading:a,selectedPdf:r,onSubmit:n,errorMessage:i}=e,{isActionLoading:o}=(0,m.P)(),c=l.filter(e=>["4179","4180","4181","4182","4183","4184","4185","4186","4187","4188","4189"].includes(e.id)),d=[{id:"GROCERY",name:"GROCERY"},{id:"BEER",name:"BEER"},{id:"MEAT",name:"MEAT"},{id:"SEAFOOD",name:"SEAFOOD"},{id:"PRODUCE",name:"PRODUCE"},{id:"FLORAL",name:"FLORAL"},{id:"DELI",name:"DELI"},{id:"BAKERY",name:"BAKERY"},{id:"PIZZA",name:"PIZZA"},{id:"CHEESE",name:"CHEESE"},{id:"DAIRY",name:"DAIRY"},{id:"FROZEN",name:"FROZEN"},{id:"SUSHI",name:"SUSHI"},{id:"BAKERY_PRODUCTION",name:"BAKERY PRODUCTION"},{id:"MOZZARELLA_PRODUCTION",name:"MOZZARELLA PRODUCTION"}];return(0,t.jsx)(L.lV,{...s,children:(0,t.jsxs)("form",{onSubmit:s.handleSubmit(n),className:"space-y-4",children:[(0,t.jsx)(L.zB,{control:s.control,name:"storeFrom",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Store From"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(B,{vendors:c,selectedVendor:s.value,setSelectedVendor:s.onChange,disabled:!r||a||o,searchPlaceholder:"Search store...",selectText:"Select store...",categoryLabel:"Store"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"storeTo",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Store To"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(B,{vendors:c,selectedVendor:s.value,setSelectedVendor:s.onChange,disabled:!r||a||o,searchPlaceholder:"Search store...",selectText:"Select store...",categoryLabel:"Store"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"departmentTo",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Department To"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(B,{vendors:d,selectedVendor:s.value,setSelectedVendor:s.onChange,disabled:!r||o,searchPlaceholder:"Search department...",selectText:"Select department...",categoryLabel:"Department"})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(L.zB,{control:s.control,name:"invoiceDate",render:e=>{let{field:s}=e;return(0,t.jsxs)(L.eI,{children:[(0,t.jsx)(L.lR,{children:"Invoice Date"}),(0,t.jsx)(L.MJ,{children:(0,t.jsx)(z.l,{date:s.value,handleDateChange:s.onChange,disabled:!r||o})}),(0,t.jsx)(L.C5,{})]})}}),(0,t.jsx)(_,{message:i}),(0,t.jsx)(N.$,{type:"submit",className:"w-full",disabled:o||!r,children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 size-4"}),"Upload Inter-Store Transfer"]})})]})})}function et(e){let{documentType:s,setDocumentType:l,invoiceForm:a,creditMemoForm:r,interStoreTransferForm:n,nonInvoiceForm:i,otherForm:o,vendors:c,vendorsLoading:d,selectedPdf:u,onInvoiceSubmit:x,onCreditMemoSubmit:f,onInterStoreTransferSubmit:p,onNonInvoiceSubmit:g,onOtherSubmit:j}=e,{errorMessage:y,isActionLoading:w}=(0,m.P)();return(0,t.jsxs)(v,{className:"h-[calc(100vh-64px-52px-24px)] lg:h-[calc(100vh-64px-24px)]",children:[(0,t.jsxs)("div",{className:"h-[70px] border-b p-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsx)("h2",{className:"text-lg font-semibold",children:"Process Document"})}),(0,t.jsx)("div",{className:"truncate text-xs text-gray-500",children:"Select document type and provide details"})]}),(0,t.jsx)("div",{className:"h-[calc(100vh-64px-52px-24px-70px)] overflow-y-auto p-2 px-3 lg:h-[calc(100vh-64px-24px-70px)]",children:(0,t.jsx)("div",{className:"flex h-full flex-col",children:(0,t.jsx)("div",{className:"flex-1 p-6",children:(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Document Type"}),(0,t.jsxs)(R.l6,{value:s||"",onValueChange:e=>l(e),children:[(0,t.jsx)(R.bq,{className:"w-full max-lg:text-xs max-lg:placeholder:text-xs",children:(0,t.jsx)(R.yv,{placeholder:"Select document type"})}),(0,t.jsx)(R.gC,{children:(0,t.jsxs)(R.s3,{children:[(0,t.jsx)(R.eb,{value:"invoice",children:"Invoice"}),(0,t.jsx)(R.eb,{value:"production-order",children:"Production Order"}),(0,t.jsx)(R.eb,{value:"inter-store-transfer",children:"Inter-Store Transfer"}),(0,t.jsx)(R.eb,{value:"credit-memo",children:"Credit Memo"}),(0,t.jsx)(R.eb,{value:"deposit-slip",children:"Deposit Slip"}),(0,t.jsx)(R.eb,{value:"coversheets",children:"Coversheets"}),(0,t.jsx)(R.eb,{value:"delivery-pick-tickets",children:"Delivery/Pick Tickets"}),(0,t.jsx)(R.eb,{value:"paid-out-receipts",children:"Paid out receipts"}),(0,t.jsx)(R.eb,{value:"house-charge",children:"House Charge Receipts"}),(0,t.jsx)(R.eb,{value:"toast",children:"Toast"}),(0,t.jsx)(R.eb,{value:"other",children:"Custom"})]})})]})]}),"invoice"===s||"production-order"===s?(0,t.jsx)(Q,{form:a,vendors:c,vendorsLoading:d,selectedPdf:u,onSubmit:x,documentType:s,errorMessage:y||""}):"credit-memo"===s?(0,t.jsx)(es,{form:r,vendors:c,vendorsLoading:d,selectedPdf:u,onSubmit:f,errorMessage:y||""}):"inter-store-transfer"===s?(0,t.jsx)(el,{form:n,vendors:c,vendorsLoading:d,selectedPdf:u,onSubmit:p,errorMessage:y||""}):s&&["deposit-slip","coversheets","delivery-pick-tickets","paid-out-receipts","house-charge","toast","inter-store-transfer"].includes(s)?(0,t.jsx)(q,{form:i,documentType:s,selectedPdf:u,onSubmit:g,errorMessage:y||""}):s&&"other"===s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(ee,{form:o,selectedPdf:u,onSubmit:j}),(0,t.jsx)(_,{message:y}),(0,t.jsx)(N.$,{type:"button",onClick:()=>j(o.getValues(),"upload"),className:"w-full",disabled:null!=w&&w||!u,children:null!=w&&w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(h.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"mr-2 size-4"}),"Upload to Non-Invoice Folder"]})})]}):(0,t.jsx)("div",{className:"py-8 text-center text-gray-500",children:"Please select a document type to continue"})]})})})})]})}l(934);var ea=l(1649);let er=async e=>{if(!window.ipc)return{error:!0,message:"Window IPC is not available"};{let s=await window.ipc.renameDocument(e);return s.success?{success:!0,data:{newPath:s.newFilePath,originalPath:s.originalPath}}:{error:!0,message:s.error}}},en=async e=>{if(!window.ipc)return{success:!1,message:"Window IPC is not available"};{let s=await window.ipc.uploadPdf(e);return s.success?s:{success:!1,message:s.error}}},ei=async e=>{if(!window.ipc)return{success:!1,message:"Window IPC is not available"};{let s=await window.ipc.moveFileToZDrive(e);return s.success?{success:!0,data:s}:{success:!1,message:s.error}}},eo=async e=>{try{let s=await ea.A.delete("http://localhost:5000/delete-file",{data:e,timeout:1e4,headers:{"Content-Type":"application/json"}});return{success:!0,data:s.data}}catch(t){var s,l;let e=(null===(l=t.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.message)||t.message||"Unexpected error occurred";return{error:!0,message:"Delete failed: ".concat(e)}}};var ec=l(1550);function ed(){let[e,s]=(0,a.useState)(!0),[l,h]=(0,a.useState)(""),[x,f]=(0,a.useState)([]),[p,g]=(0,a.useState)(!0),[v,j]=(0,a.useState)(null),{storeId:y,date:w,activeTab:b,selectedPdf:P,setSelectedPdf:S,setDirectoryExists:D,directoryPaths:F,setPdfFiles:T,setDeletingPdf:E,setErrorMessage:R,setIsActionLoading:A}=(0,m.P)(),L=(0,r.mN)({resolver:(0,n.u)(u.Uc),defaultValues:{filePath:"",vendorId:"",invoiceNumber:"",invoiceDate:(0,i.f)(new Date,0),documentType:"invoice",invoiceTotal:0}}),z=(0,r.mN)({resolver:(0,n.u)(u.rN),defaultValues:{filePath:"",vendorId:"",creditMemoNumber:"",creditMemoDate:(0,i.f)(new Date,0),documentType:"credit-memo"}}),M=(0,r.mN)({resolver:(0,n.u)(u.W9),defaultValues:{filePath:"",storeFrom:"",storeTo:"",departmentTo:"",invoiceDate:(0,i.f)(new Date,0),documentType:"inter-store-transfer"}}),O=(0,r.mN)({resolver:(0,n.u)(u.YP),defaultValues:{filePath:"",date:(0,i.f)(new Date,0),documentType:"deposit-slip"}}),k=(0,r.mN)({resolver:(0,n.u)(u.UE),defaultValues:{filePath:"",newFileName:"",documentType:"other"}}),V=(0,a.useCallback)(async(e,l)=>{if(console.log("fetchPdfFiles",e,l),!l){console.log("directoryPath is empty"),D(s=>({...s,[e]:!1})),S(null),T([]),s(!1);return}try{if(s(!0),console.log("directoryPath:",l),window.ipc){let s=await window.ipc.getPdfFiles(l);if(s.success){var t;D(l=>({...l,[e]:s.folderExists}));let l=(null==s?void 0:null===(t=s.files)||void 0===t?void 0:t.map(e=>({originalPath:e.path,httpPath:e.path})))||[];T(l),0===l.length?S(null):S(l[0])}else d.oR.error("Failed to fetch PDFs"),D(l=>({...l,[e]:s.folderExists}))}}catch(s){console.log("Error fetching ".concat(e," files:"),s),T([])}finally{s(!1)}},[D,S,T]);(0,a.useEffect)(()=>{P&&(L.setValue("filePath",P.originalPath),O.setValue("filePath",P.originalPath),k.setValue("filePath",P.originalPath))},[P,L,O]),(0,a.useEffect)(()=>{v&&"invoice"!==v&&O.setValue("documentType",v)},[v,O]),(0,a.useEffect)(()=>{(async function(){try{if(g(!0),window.ipc){let e=await window.ipc.getVendors();console.log({vendorData:e}),e&&Array.isArray(e)&&f(e)}}catch(e){console.log("Failed to fetch vendors:",e)}finally{g(!1)}})()},[]),(0,a.useEffect)(()=>{console.log("activeTab changed:",b);let e=F[b];"scans"===b?(console.log("fetching scans in ",e),V("scans",e)):"non-invoice"===b?(console.log("fetching non-invoice in ",e),V("non-invoice",e)):"bills"===b&&F.bills&&(console.log("fetching bills in ",e),V("bills",e))},[b,V,F]);let B=e=>{"bills"===e?V(e,F[e]):"scans"===e?V(e,F[e]):"non-invoice"===e&&V(e,F[e])},U=async e=>{if(console.log({data:e}),R(void 0),!P){console.log("Please select a PDF file");return}try{var s;A(!0);let l=e.invoiceDate.toISOString().split("T")[0],t=e.vendorId,a=e.invoiceNumber,r=null===(s=x.find(e=>e.id===t))||void 0===s?void 0:s.asn_flag,n="".concat(t,"_").concat(a,"_").concat(l).concat(r?"_ASN":"",".pdf"),o=await er({filePath:P.originalPath,newFileName:n,documentType:v,vendorId:t,invoiceNumber:a,invoiceDate:l});if(o.error)throw Error(o.message);let c={...P,originalPath:o.data.newPath};S(c);let m=await ei({filePath:o.data.newPath,directoryPath:"invoice"===v?F.bills:F["non-invoice"],documentType:v});if(!1===m.success)throw Error(m.message);let u=m.data.newPath;if("invoice"===v){let s=await en({filePath:u,vendorId:t,invoiceNumber:a,invoiceDate:l,documentType:"invoice",store:y,invoiceTotal:e.invoiceTotal});if(!1===s.success)throw Error(s.message);console.log("uploadResult",s)}await V("scans",F[b]),d.oR.success("Invoice uploaded successfully."),setTimeout(()=>{L.reset({filePath:"",vendorId:"",invoiceNumber:"",invoiceDate:(0,i.f)(new Date,0),documentType:"invoice",invoiceTotal:0}),j(null)},0)}catch(e){console.log("Error in rename and upload process:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the rename and upload process"))}finally{A(!1)}},_=async e=>{if(console.log("handleUploadNonInvoice",e),R(void 0),!P){R("Please select a PDF file");return}try{A(!0),console.log("Processing non-invoice document:",e),console.log("Step 1: Starting file rename...");let s=e.date.toISOString().split("T")[0],l="".concat(e.documentType,"_").concat(s,".pdf"),t=await er({filePath:P.originalPath,newFileName:l,documentType:e.documentType});if(t.error)throw Error(t.message);let a={...P,originalPath:t.data.newPath};S(a);let r=await ei({filePath:t.data.newPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===r.success)throw Error(r.message);await V("scans",F[b]),d.oR.success("".concat(v," uploaded successfully.")),setTimeout(()=>{O.reset({filePath:"",date:(0,i.f)(new Date,0),documentType:"deposit-slip"}),j(null)},0)}catch(e){console.log("Error in non-invoice processing:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the non-invoice processing"))}finally{A(!1)}},$=async(e,s)=>{if(console.log("handleUploadOther",e,s),R(void 0),!P){R("Please select a PDF file");return}A(!0);try{console.log("handleUploadOther",e,s);let l=e.newFileName;if(e.date){let s=e.date.toISOString().split("T")[0];l="".concat(e.newFileName,"_").concat(s,".pdf")}else l="".concat(e.newFileName,".pdf");if("rename"===s){let s=await er({filePath:P.originalPath,newFileName:l,documentType:e.documentType});if(s.error)throw Error(s.message)}else if("upload"===s){let s=await ei({filePath:P.originalPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===s.success)throw Error(s.message);setTimeout(()=>{k.reset({filePath:"",newFileName:"",date:void 0,documentType:"other"}),j(null)},0)}await V("scans",F[b]),d.oR.success("Success! ".concat("rename"===s?"Renamed successfully":"Moved to Non-Invoice folder."))}catch(e){R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the other processing"))}finally{A(!1)}},J=async e=>{if(R(void 0),!P){console.log("Please select a PDF file");return}try{A(!0);let s=e.creditMemoDate.toISOString().split("T")[0],l=e.creditMemoNumber,t="".concat(e.vendorId,"_").concat(e.documentType,"_").concat(s,".pdf");l&&(t="".concat(e.vendorId,"_").concat(e.documentType,"_").concat(l,"_").concat(s,".pdf"));let a=await er({filePath:P.originalPath,newFileName:t,documentType:e.documentType});if(a.error)throw Error(a.message);let r={...P,originalPath:a.data.newPath};S(r);let n=await ei({filePath:a.data.newPath,directoryPath:F.bills,documentType:"credit-memo"});if(!1===n.success)throw Error(n.message);let o=n.data.newPath,c=await en({filePath:o,vendorId:e.vendorId,invoiceNumber:e.creditMemoNumber||"",invoiceDate:s,documentType:"credit-memo",store:y,invoiceTotal:0});if(!1===c.success)throw Error(c.message);console.log("uploadResult",c),await V("scans",F[b]),d.oR.success("Credit Memo uploaded successfully."),setTimeout(()=>{z.reset({filePath:"",creditMemoNumber:"",creditMemoDate:(0,i.f)(new Date,0),documentType:"credit-memo"})},0)}catch(e){R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the credit memo processing"))}finally{A(!1)}},Y=async e=>{if(R(void 0),!P){R("Please select a PDF file");return}try{A(!0);let s=e.invoiceDate.toISOString().split("T")[0],l="".concat(e.documentType,"_").concat(e.storeFrom,"_").concat(e.storeTo,"-").concat(e.departmentTo,"_").concat(s,".pdf"),t=await er({filePath:P.originalPath,newFileName:l,documentType:e.documentType});if(t.error)throw Error(t.message);let a={...P,originalPath:t.data.newPath};S(a);let r=await ei({filePath:t.data.newPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===r.success)throw Error(r.message);await V("scans",F[b]),d.oR.success("Inter Store Transfer uploaded successfully."),setTimeout(()=>{M.reset({filePath:"",storeFrom:"",storeTo:"",departmentTo:"",invoiceDate:(0,i.f)(new Date,0),documentType:"inter-store-transfer"})},0)}catch(e){console.log("Error in inter-store transfer processing:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the inter-store transfer processing"))}finally{A(!1)}},Z=async e=>{E(e);let s=d.oR.loading("Deleting file...");try{let l=await eo({filePath:e});if(l.error){d.oR.error("Failed delete: ".concat(l.message),{id:s});return}l.success&&(d.oR.success("File deleted successfully",{id:s}),(null==P?void 0:P.originalPath)===e&&S(null),await V(b,F[b]))}catch(e){d.oR.error("Delete error: ".concat(e instanceof Error?e.message:"Unknown error"),{id:s})}finally{E(void 0)}};return y?(0,t.jsxs)(ec.cj,{children:[(0,t.jsx)(ec.CG,{asChild:!0,children:(0,t.jsxs)(N.$,{className:"ml-3 mt-3 flex items-center gap-2 capitalize lg:hidden",children:[(0,t.jsx)(c.A,{className:"size-4"})," ","scans"!==b&&w&&"".concat(w.toLocaleDateString()," "),b," Folder"]})}),(0,t.jsxs)(ec.h,{side:"left",children:[(0,t.jsxs)(ec.Fm,{className:"sr-only",children:[(0,t.jsx)(ec.qp,{children:"PDF Files List Sidebar"}),(0,t.jsx)(ec.Qs,{children:"Select a folder to view the files"})]}),(0,t.jsx)(C,{loading:e,filterQuery:l,setFilterQuery:h,onRefresh:B,onDelete:Z})]}),(0,t.jsxs)("div",{className:"grid h-[calc(100vh-64px-52px)] w-screen grid-cols-12 gap-3 p-3 lg:h-[calc(100vh-64px)]",children:[(0,t.jsx)("div",{className:"col-span-3 h-[calc(100vh-64px-52px-24px)] transition-all duration-300 max-lg:hidden lg:h-[calc(100vh-64px-24px)]",children:(0,t.jsx)(C,{loading:e,filterQuery:l,setFilterQuery:h,onRefresh:B,onDelete:Z})}),(0,t.jsx)("div",{className:"lg:col-span-11 ".concat("scans"===b?"col-span-8 lg:col-span-6":"col-span-12 lg:col-span-9"," h-[calc(100vh-64px-52px-24px)] transition-all duration-300 lg:h-[calc(100vh-64px-24px)]"),children:(0,t.jsx)(I,{})}),"scans"===b&&(0,t.jsx)("div",{className:"col-span-4 h-[calc(100vh-64px-52px-24px)] transition-all duration-300 lg:col-span-3 lg:h-[calc(100vh-64px-24px)]",children:(0,t.jsx)(et,{documentType:v,setDocumentType:j,invoiceForm:L,creditMemoForm:z,interStoreTransferForm:M,nonInvoiceForm:O,otherForm:k,vendors:x,vendorsLoading:p,selectedPdf:P||void 0,onInvoiceSubmit:U,onCreditMemoSubmit:J,onInterStoreTransferSubmit:Y,onNonInvoiceSubmit:_,onOtherSubmit:$},"".concat(v,"-").concat((null==P?void 0:P.originalPath)||"no-pdf"))})]})]}):(0,t.jsx)("div",{className:"flex h-full w-screen items-center justify-center py-20",children:(0,t.jsx)("div",{className:"rounded-lg bg-white p-8 shadow-lg dark:bg-gray-800",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-primary mb-4",children:(0,t.jsx)(o.A,{className:"mx-auto size-10"})}),(0,t.jsx)("h2",{className:"text-lg font-medium",children:"Welcome to Bills Utility"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"Select a store to get started"})]})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[425,951,228,347,239,358],()=>s(4311)),_N_E=e.O()}]);