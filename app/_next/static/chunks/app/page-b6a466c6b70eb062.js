(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4311:(e,t,s)=>{Promise.resolve().then(s.bind(s,7013))},7013:(e,t,s)=>{"use strict";s.d(t,{BillManager2:()=>eN});var a=s(3365),n=s(1521),l=s(1252),r=s(5850),o=s(2074),i=s(4715),c=s(4693),d=s(2812),u=s(7027),m=s(1076),x=s(9915),h=s(127),f=s(4191),p=s(6655),g=s(1114);let v=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});v.displayName="Card",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("flex flex-col space-y-1.5 p-6",s),...n})}).displayName="CardHeader",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})}).displayName="CardTitle",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("text-sm text-muted-foreground",s),...n})}).displayName="CardDescription",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("p-6 pt-0",s),...n})}).displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,g.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter";var j=s(8699),y=s(4125),N=s(243);let w=N.bL,b=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(N.B8,{ref:t,className:(0,g.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});b.displayName=N.B8.displayName;let P=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(N.l9,{ref:t,className:(0,g.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});P.displayName=N.l9.displayName;let S=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(N.UC,{ref:t,className:(0,g.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});S.displayName=N.UC.displayName;let D=e=>{let{directory:t,directoryExists:s,onRefresh:n}=e,{setDirectoryPaths:l,activeTab:r,directoryPaths:o}=(0,u.P)(),i=async()=>{try{if(window.ipc){let e=await window.ipc.selectDirectory();e&&(l({...o,[r]:e}),n(r))}else{let e=document.createElement("input");e.type="file",e.webkitdirectory=!0,e.onchange=async e=>{let t=e.target.files;if(t&&t.length>0){let e=t[0].path.split("\\").slice(0,-1).join("\\");l({...o,[r]:e}),n(r)}},e.click()}}catch(e){d.oR.error(e instanceof Error?e.message:"Failed to select directory")}};return(console.log("directory",t),console.log("directoryExists",s),console.log(o),s)?(0,a.jsx)("p",{children:"Folder has no PDF files to display."}):(0,a.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,a.jsxs)("p",{children:['Directory: "',t,'" ',(0,a.jsx)("br",{}),"was not found."]}),(0,a.jsx)(y.$,{onClick:i,children:"Select Directory"})]})};function C(e){var t,s;let{loading:l,filterQuery:r,setFilterQuery:o,onRefresh:i,onPdfLoaded:c}=e,{date:d,activeTab:m,setActiveTab:N,directoryExists:C,directoryPaths:F,selectedPdf:T,setSelectedPdf:E,pdfFiles:z,setPdfFiles:R,deletingPdf:I}=(0,u.P)(),{pdfDisplay:A,loadPdf:_,clearPdf:L}=function(){let[e,t]=(0,n.useState)({url:null,fileName:null,isLoading:!1,error:null,cleanup:null}),s=async s=>{e.cleanup&&e.cleanup(),t(e=>({...e,isLoading:!0,error:null,url:null}));try{let{url:e,fileName:a,cleanup:n}=await (0,g.k)(s);return t({url:e,fileName:a,isLoading:!1,error:null,cleanup:n}),console.log("PDF loaded successfully: ".concat(a)),{url:e,fileName:a}}catch(s){let e=s instanceof Error?s.message:"Failed to load PDF";throw t(t=>({...t,isLoading:!1,error:e})),console.error("Failed to load PDF:",s),s}};return(0,n.useEffect)(()=>()=>{e.cleanup&&e.cleanup()},[e.cleanup]),{pdfDisplay:e,loadPdf:s,clearPdf:()=>{e.cleanup&&e.cleanup(),t({url:null,fileName:null,isLoading:!1,error:null,cleanup:null})}}}(),k=async e=>{console.log("CLICKED PDF: ",e),E(e);try{await _(e.originalPath)}catch(e){console.error("Failed to load PDF for display:",e)}};(0,n.useEffect)(()=>{!T&&A.url&&L()},[T,A.url,L]);let M=()=>({isLoading:A.isLoading,url:A.url,fileName:A.fileName,error:A.error,hasActivePdf:!!A.url});(0,n.useEffect)(()=>{A.url&&(console.log("PDF blob URL ready:",A.url),console.log("Current PDF state:",M()),null==c||c(M()))},[A.url,c]);let O=z.filter(e=>(e.originalPath.split("\\").pop()||"").toLowerCase().includes(r.toLowerCase())),V=(e,t,s)=>{var n;return(0,a.jsx)("div",{className:"p-2 px-3",children:l?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)(x.A,{className:"text-primary size-6 animate-spin"})}):0===e.length?(0,a.jsx)("div",{className:"text-muted-foreground px-3 py-8 text-center text-sm",children:r.length>0?"No matching files found":(0,a.jsx)(D,{directory:s,directoryExists:null!==(n=null==C?void 0:C[m])&&void 0!==n&&n,onRefresh:i})}):(0,a.jsx)("ul",{className:"space-y-1.5",children:e.map((e,t)=>{let s=e.originalPath.split("\\").pop()||"";return(0,a.jsx)("li",{className:"group relative cursor-pointer",children:(0,a.jsxs)("div",{className:(0,y.r)({className:"h-auto w-full justify-start px-2 py-1.5",variant:(null==T?void 0:T.originalPath)===e.originalPath?"default":"ghost"}),onClick:()=>k(e),children:[(0,a.jsx)(h.A,{className:"mr-2 size-4"}),I===e.originalPath?(0,a.jsxs)("span",{className:"flex-1 truncate",children:["Deleting..."," ",(0,a.jsx)(f.A,{className:"ml-2 size-4 animate-spin"})]}):A.isLoading&&(null==T?void 0:T.originalPath)===e.originalPath?(0,a.jsxs)("span",{className:"flex flex-1 items-center truncate",children:["Loading PDF..."," ",(0,a.jsx)(f.A,{className:"ml-2 size-4 animate-spin"})]}):(0,a.jsx)("span",{className:"flex-1 truncate",children:s}),A.error&&(null==T?void 0:T.originalPath)===e.originalPath&&(0,a.jsx)("span",{className:"ml-2 text-xs text-red-500",children:"Failed"})]})},t)})})})},B=(e,t,s)=>(0,a.jsxs)("div",{className:"border-b p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text font-semibold",children:e}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(y.$,{variant:"ghost",size:"icon",onClick:()=>i(s),disabled:l,className:"size-8",children:(0,a.jsx)(x.A,{className:"size-4 ".concat(l?"animate-spin":"")})})})]}),(0,a.jsx)("div",{className:"mt-2 text-xs text-gray-500",children:t||"No directory selected"}),(0,a.jsxs)("div",{className:"relative mt-3",children:[(0,a.jsx)(p.A,{className:"text-muted-foreground absolute left-2 top-2.5 size-4"}),(0,a.jsx)(j.p,{placeholder:"Search ".concat(e.toLowerCase(),"..."),className:"pl-8",value:r,onChange:e=>o(e.target.value)})]})]});return(0,a.jsx)(v,{className:"flex h-[calc(100vh-64px-24px)] max-h-full flex-col",children:(0,a.jsxs)(w,{defaultValue:"scans",value:m,className:"flex h-full flex-col",onValueChange:e=>{R([]),N(e)},children:[(0,a.jsxs)(b,{className:"mx-auto mt-2 w-[95%]",children:[(0,a.jsx)(P,{value:"scans",className:"w-full",children:"Scans"}),(0,a.jsx)(P,{value:"bills",className:"w-full",children:"Bills"}),(0,a.jsx)(P,{value:"non-invoice",className:"w-full",children:"Non-Invoice"})]}),"scans"===m&&(0,a.jsxs)(S,{value:"scans",className:"flex flex-1 flex-col overflow-hidden",children:[B("Scans",F.scans,"scans"),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:V(O,"No scans found in this directory",F.scans)})]}),"bills"===m&&(0,a.jsxs)(S,{value:"bills",className:"flex flex-1 flex-col overflow-hidden",children:[B("".concat(null!==(t=null==d?void 0:d.toLocaleDateString())&&void 0!==t?t:""," Bills"),F.bills,"bills"),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:V(O,"No bills found in this directory",F.bills)})]}),"non-invoice"===m&&(0,a.jsxs)(S,{value:"non-invoice",className:"flex flex-1 flex-col overflow-hidden",children:[B("".concat(null!==(s=null==d?void 0:d.toLocaleDateString())&&void 0!==s?s:""," Non-Invoice Documents"),F["non-invoice"],"non-invoice"),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:V(O,"No non-invoice documents found in this directory",F["non-invoice"])})]})]})})}var F=s(5278),T=s(6871),E=s(8848);function z(){let{selectedPdf:e,isActionLoading:t,pdfFiles:s,setSelectedPdf:l}=(0,u.P)(),[r,o]=(0,n.useState)({url:null,fileName:null,isLoading:!1,error:null,cleanup:null});if((0,n.useEffect)(()=>{(async()=>{if(r.cleanup&&r.cleanup(),!e){o({url:null,fileName:null,isLoading:!1,error:null,cleanup:null});return}if(t){console.log("PDF loading skipped - action in progress, keeping current PDF visible"),o(e=>({...e,isLoading:!1,error:null}));return}o(e=>({...e,isLoading:!0,error:null}));try{let{url:t,fileName:s,cleanup:a}=await (0,g.k)(e.originalPath);o({url:t,fileName:s,isLoading:!1,error:null,cleanup:a}),console.log("PDF viewer loaded: ".concat(s))}catch(s){let e=s instanceof Error?s.message:"Failed to load PDF";t?(console.log("PDF load error during action (expected):",e),o(e=>({...e,isLoading:!1,error:null}))):(o(t=>({...t,isLoading:!1,error:e})),console.error("PDF viewer error:",s))}})()},[e,t]),(0,n.useEffect)(()=>()=>{r.cleanup&&r.cleanup()},[r.cleanup]),!e)return(0,a.jsx)(v,{className:"flex h-[calc(100vh-64px-52px-24px)] flex-col lg:h-[calc(100vh-64px-24px)]",children:(0,a.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,a.jsx)(h.A,{className:"text-muted-foreground/40 size-16"}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No Document Selected"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:"Select a document from the sidebar to preview it"})]})});let i=s.findIndex(t=>t.originalPath===e.originalPath);return(0,a.jsxs)(v,{className:"flex h-[calc(100vh-64px-52px-24px)] flex-col lg:h-[calc(100vh-64px-24px)]",children:[(0,a.jsxs)("div",{className:"flex h-[70px] items-center justify-between border-b p-3",children:[(0,a.jsxs)("div",{className:"overflow-hidden",children:[(0,a.jsx)("h2",{className:"truncate font-semibold",children:r.fileName||e.originalPath.split("\\").pop()}),(0,a.jsx)("p",{className:"text-muted-foreground truncate text-xs",children:e.originalPath})]}),(0,a.jsxs)("div",{className:"flex flex-nowrap items-center gap-3",children:[(0,a.jsx)(y.$,{variant:"outline",size:"icon",onClick:()=>{let e=i-1;e>=0&&l(s[e])},disabled:0===i,className:"size-8",children:(0,a.jsx)(F.A,{className:"size-4"})}),(0,a.jsxs)("span",{className:"text-muted-foreground whitespace-nowrap text-sm",children:[i+1," / ",s.length]}),(0,a.jsx)(y.$,{variant:"outline",size:"icon",onClick:()=>{let e=i+1;e<s.length&&l(s[e])},disabled:i===s.length-1,className:"size-8",children:(0,a.jsx)(T.A,{className:"size-4"})})]})]}),(0,a.jsx)("div",{className:"h-[calc(100vh-64px-52px-24px-70px)] lg:h-[calc(100vh-64px-24px-70px)]",children:r.isLoading?(0,a.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,a.jsx)(f.A,{className:"text-primary size-8 animate-spin"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-4 text-sm",children:"Loading PDF..."})]}):r.error&&!t?(0,a.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,a.jsx)(E.A,{className:"size-16 text-red-500/40"}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium text-red-600",children:"Failed to Load PDF"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:r.error}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1 text-center text-xs",children:"Please try selecting the document again"})]}):r.url?(0,a.jsx)("div",{className:"h-full p-3",children:(0,a.jsx)("div",{className:"h-full w-full",children:(0,a.jsxs)("object",{data:r.url,type:"application/pdf",className:"size-full rounded-lg border","aria-label":"PDF viewer for ".concat(r.fileName),children:[(0,a.jsx)("embed",{src:r.url,type:"application/pdf",className:"size-full rounded-lg"}),(0,a.jsxs)("div",{className:"flex h-full flex-col items-center justify-center p-6",children:[(0,a.jsx)(h.A,{className:"text-muted-foreground/40 size-16"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-4 text-sm",children:"Your browser doesn't support PDF viewing."}),(0,a.jsx)("a",{href:r.url,download:r.fileName,className:"text-primary mt-2 text-sm underline hover:no-underline",children:"Download PDF instead"})]})]})})}):(0,a.jsxs)("div",{className:"flex h-[calc(100vh-12rem-52px)] flex-col items-center justify-center p-6 lg:h-[calc(100vh-12rem)]",children:[(0,a.jsx)(h.A,{className:"text-muted-foreground/40 size-16"}),(0,a.jsx)("h3",{className:"mt-4 text-lg font-medium",children:"No PDF Content"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-center text-sm",children:"Unable to load PDF content"})]})})]})}var R=s(7761),I=s(6),A=s(6805),_=s(8180),L=s(9262),k=s(9308),M=s(2180),O=s(6733),V=s(9813),B=s(3570),U=s(2979);function $(){let e=(0,k._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return $=function(){return e},e}function J(){let e=(0,k._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return J=function(){return e},e}function Y(e){let{className:t,classNames:s,showOutsideDays:n=!0,captionLayout:l="label",buttonVariant:r="ghost",formatters:o,components:i,...c}=e,d=(0,B.a)();return(0,a.jsx)(U.h,{showOutsideDays:n,className:(0,g.cn)("bg-background group/calendar p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw($()),String.raw(J()),t),captionLayout:l,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...o},classNames:{root:(0,g.cn)("w-fit",d.root),months:(0,g.cn)("relative flex flex-col gap-4 md:flex-row",d.months),month:(0,g.cn)("flex w-full flex-col gap-4",d.month),nav:(0,g.cn)("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",d.nav),button_previous:(0,g.cn)((0,y.r)({variant:r}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",d.button_previous),button_next:(0,g.cn)((0,y.r)({variant:r}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",d.button_next),month_caption:(0,g.cn)("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",d.month_caption),dropdowns:(0,g.cn)("flex h-[--cell-size] w-full items-center justify-center gap-1.5 text-sm font-medium",d.dropdowns),dropdown_root:(0,g.cn)("has-focus:border-ring border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] relative rounded-md border",d.dropdown_root),dropdown:(0,g.cn)("absolute inset-0 opacity-0",d.dropdown),caption_label:(0,g.cn)("select-none font-medium","label"===l?"text-sm":"[&>svg]:text-muted-foreground flex h-8 items-center gap-1 rounded-md pl-2 pr-1 text-sm [&>svg]:size-3.5",d.caption_label),table:"w-full border-collapse",weekdays:(0,g.cn)("flex",d.weekdays),weekday:(0,g.cn)("text-muted-foreground flex-1 select-none rounded-md text-[0.8rem] font-normal",d.weekday),week:(0,g.cn)("mt-2 flex w-full",d.week),week_number_header:(0,g.cn)("w-[--cell-size] select-none",d.week_number_header),week_number:(0,g.cn)("text-muted-foreground select-none text-[0.8rem]",d.week_number),day:(0,g.cn)("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",d.day),range_start:(0,g.cn)("bg-accent rounded-l-md",d.range_start),range_middle:(0,g.cn)("rounded-none",d.range_middle),range_end:(0,g.cn)("bg-accent rounded-r-md",d.range_end),today:(0,g.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",d.today),outside:(0,g.cn)("text-muted-foreground aria-selected:text-muted-foreground",d.outside),disabled:(0,g.cn)("text-muted-foreground opacity-50",d.disabled),hidden:(0,g.cn)("invisible",d.hidden),...s},components:{Root:e=>{let{className:t,rootRef:s,...n}=e;return(0,a.jsx)("div",{"data-slot":"calendar",ref:s,className:(0,g.cn)(t),...n})},Chevron:e=>{let{className:t,orientation:s,...n}=e;return"left"===s?(0,a.jsx)(M.A,{className:(0,g.cn)("size-4",t),...n}):"right"===s?(0,a.jsx)(O.A,{className:(0,g.cn)("size-4",t),...n}):(0,a.jsx)(V.A,{className:(0,g.cn)("size-4",t),...n})},DayButton:Z,WeekNumber:e=>{let{children:t,...s}=e;return(0,a.jsx)("td",{...s,children:(0,a.jsx)("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:t})})},...i},...c})}function Z(e){let{className:t,day:s,modifiers:l,...r}=e,o=(0,B.a)(),i=n.useRef(null);return n.useEffect(()=>{var e;l.focused&&(null===(e=i.current)||void 0===e||e.focus())},[l.focused]),(0,a.jsx)(y.$,{ref:i,variant:"ghost",size:"icon","data-day":s.date.toLocaleDateString(),"data-selected-single":l.selected&&!l.range_start&&!l.range_end&&!l.range_middle,"data-range-start":l.range_start,"data-range-end":l.range_end,"data-range-middle":l.range_middle,className:(0,g.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] [&>span]:text-xs [&>span]:opacity-70",o.day,t),...r})}var W=s(4172);function K(e){let{date:t,handleDateChange:s,disabled:n=!1,className:l}=e;return(0,a.jsxs)(W.AM,{children:[(0,a.jsx)(W.Wv,{asChild:!0,children:(0,a.jsxs)(y.$,{variant:"outline",className:(0,g.cn)("w-full justify-start text-left font-normal max-lg:text-xs",!t&&"text-muted-foreground",l),disabled:n,children:[(0,a.jsx)(L.A,{className:"mr-2 size-4"}),t?(0,_.GP)(t,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(W.hl,{className:"w-auto p-0",children:(0,a.jsx)(Y,{mode:"single",selected:t,onSelect:s,captionLayout:"dropdown",disabled:e=>e>new Date||e<new Date("1900-01-01")})})]})}var G=s(5114),H=s(3689),Q=s(5958);function q(e){let{vendors:t,selectedVendor:s,setSelectedVendor:l,disabled:r=!1,searchPlaceholder:o="Search vendor...",selectText:i="Select vendor...",categoryLabel:c="Vendor"}=e,[d,u]=n.useState(!1),m=n.useMemo(()=>{let e=t.find(e=>e.id===s);return e?e.name:""},[t,s]);return(0,a.jsxs)(W.AM,{open:d,onOpenChange:u,children:[(0,a.jsx)(W.Wv,{asChild:!0,children:(0,a.jsxs)(y.$,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between truncate max-lg:text-xs max-lg:placeholder:text-xs",disabled:r,children:[s?m:i,(0,a.jsx)(G.A,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(W.hl,{className:"w-full p-0",children:(0,a.jsxs)(Q.uB,{children:[(0,a.jsx)(Q.G7,{placeholder:o}),(0,a.jsxs)(Q.oI,{children:[(0,a.jsx)(Q.xL,{children:"No vendor found."}),(0,a.jsx)(Q.L$,{heading:c,children:t.map(e=>(0,a.jsxs)(Q.h_,{value:e.name,onSelect:e=>{console.log({value:e});let s=t.find(t=>t.name===e);l(s?s.id:""),u(!1)},children:[(0,a.jsx)(H.A,{className:(0,g.cn)("mr-2 h-4 w-4",s===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]})}var X=s(6003);let ee=e=>{let{message:t}=e;return t?(0,a.jsxs)("div",{className:"bg-destructive/20 text-destructive flex items-center justify-center gap-x-2 rounded-md p-3 text-sm dark:text-red-400",children:[(0,a.jsx)(X.A,{className:"h-4 w-4 md:h-6 md:w-6"}),(0,a.jsx)("p",{children:t})]}):null};var et=s(9816),es=s(1538),ea=s(3798),en=s(123),el=s(2991);let er=(0,n.forwardRef)((e,t)=>{let{value:s,onChange:n,disabled:l,placeholder:r="Enter amount"}=e;return(0,a.jsx)(es.oz,{value:s||0,onChange:n,isDisabled:l,formatOptions:{style:"currency",currency:"USD",currencySign:"accounting"},children:(0,a.jsxs)(ea.Y,{className:"border-input data-focus-within:border-ring data-focus-within:ring-ring/50 data-focus-within:has-aria-invalid:ring-destructive/20 dark:data-focus-within:has-aria-invalid:ring-destructive/40 data-focus-within:has-aria-invalid:border-destructive shadow-xs data-disabled:opacity-50 data-focus-within:ring-[3px] relative inline-flex h-9 w-full items-center overflow-hidden whitespace-nowrap rounded-md border text-sm outline-none transition-[color,box-shadow]",children:[(0,a.jsx)(en.p,{ref:t,placeholder:r,className:"bg-background text-foreground flex-1 px-3 py-2 tabular-nums"}),(0,a.jsxs)("div",{className:"flex h-[calc(100%+2px)] flex-col",children:[(0,a.jsx)(el.$,{slot:"increment",className:"border-input bg-background text-muted-foreground/80 hover:bg-accent hover:text-foreground -me-px flex h-1/2 w-6 flex-1 items-center justify-center border text-sm transition-[color,box-shadow] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",children:(0,a.jsx)(et.A,{size:12,"aria-hidden":"true"})}),(0,a.jsx)(el.$,{slot:"decrement",className:"border-input bg-background text-muted-foreground/80 hover:bg-accent hover:text-foreground -me-px -mt-px flex h-1/2 w-6 flex-1 items-center justify-center border text-sm transition-[color,box-shadow] disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50",children:(0,a.jsx)(V.A,{size:12,"aria-hidden":"true"})})]})]})})});function eo(e){let{value:t,onChange:s,options:l,disabled:r=!1,placeholder:o="Select or type invoice number...",searchPlaceholder:i="Search or type...",groupLabel:c="Electronic Invoice Numbers"}=e,[d,u]=n.useState(!1),[m,x]=n.useState(""),h=n.useMemo(()=>Array.from(new Set(l.filter(Boolean))).sort(),[l]),f=n.useMemo(()=>!!h.find(e=>e.toLowerCase()===m.trim().toLowerCase()),[h,m]),p=e=>{s(e),u(!1),x("")};return(0,a.jsxs)(W.AM,{open:d,onOpenChange:e=>{!e&&m.trim()&&!f&&(s(m.trim()),x("")),u(e)},children:[(0,a.jsx)(W.Wv,{asChild:!0,children:(0,a.jsxs)(y.$,{variant:"outline",role:"combobox","aria-expanded":d,className:"w-full justify-between truncate max-lg:text-xs max-lg:placeholder:text-xs",disabled:r,children:[t||o,(0,a.jsx)(G.A,{className:"ml-2 size-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(W.hl,{className:"w-full p-0",children:(0,a.jsxs)(Q.uB,{shouldFilter:!1,children:[(0,a.jsx)(Q.G7,{value:m,onValueChange:x,placeholder:i,onKeyDown:e=>{"Enter"===e.key&&m.trim()&&!f&&(e.preventDefault(),p(m.trim()))}}),(0,a.jsxs)(Q.oI,{children:[m.trim()&&!f&&(0,a.jsx)(Q.L$,{heading:"Custom",children:(0,a.jsxs)(Q.h_,{value:m,onSelect:()=>p(m.trim()),children:["Use “",m.trim(),"”"]})}),(0,a.jsxs)(Q.xL,{children:["No electronic invoice found.",(0,a.jsx)("br",{}),"Type invoice number"]}),(0,a.jsx)(Q.L$,{heading:c,children:h.filter(e=>!m||e.toLowerCase().includes(m.trim().toLowerCase())).map(e=>(0,a.jsxs)(Q.h_,{value:e,onSelect:()=>p(e),children:[(0,a.jsx)(H.A,{className:(0,g.cn)("mr-2 h-4 w-4",t===e?"opacity-100":"opacity-0")}),e]},e))})]})]})})]})}function ei(e){let{form:t,vendors:s,vendorsLoading:l,selectedPdf:r,onSubmit:o,documentType:i,errorMessage:c}=e,{isActionLoading:d,date:m,storeId:h}=(0,u.P)(),[f,p]=(0,n.useState)([]),g=("production-order"===i?s.filter(e=>"4181"===e.id||"4183"===e.id):s).map(e=>"CONSOLID_SUPER"===e.id?{...e,name:"CSS - KoolTemp"}:e),v=async e=>{if(window.ipc&&h&&m){let t=await window.ipc.getASNs(h,"CONSOLID_SUPER"===e?"K001":e,m);(null==t?void 0:t.success)?p(t.data||[]):p([])}},j=n.useMemo(()=>Array.from(new Set((null!=f?f:[]).map(e=>{var t;return null!==(t=null==e?void 0:e.F91)&&void 0!==t?t:""}).filter(Boolean).map(String)||[])).sort(),[f]);return(0,a.jsx)(A.lV,{...t,children:(0,a.jsxs)("form",{onSubmit:t.handleSubmit(o),className:"space-y-4",children:[(0,a.jsx)(A.zB,{control:t.control,name:"vendorId",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Vendor"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(q,{vendors:g,selectedVendor:t.value,setSelectedVendor:e=>{t.onChange(e),v(e)},disabled:!r||l||d})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"invoiceNumber",render:e=>{let{field:s}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Invoice Number"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(eo,{value:s.value||"",onChange:e=>{s.onChange(e);let a=f.find(t=>String(null==t?void 0:t.F91)===String(e));if((null==a?void 0:a.Net)!=null){let e=function(e){if(null==e)return 0;let t=String(e).trim(),s=/^\(.*\)$/.test(t),a=parseFloat((t=t.replace(/[^\d.-]/g,""))||"0");return Number.isFinite(a)||(a=0),s&&a>0&&(a=-a),a}(a.Net);t.setValue("invoiceTotal",e,{shouldDirty:!0,shouldValidate:!0})}},options:j,disabled:!r||d,placeholder:"Select or type invoice number...",searchPlaceholder:"Search or type...",groupLabel:"Electronic Invoice Numbers"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"invoiceDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Invoice Date"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(K,{date:t.value,handleDateChange:t.onChange,disabled:!r||d})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"invoiceTotal",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Invoice Total"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(er,{value:t.value||0,onChange:t.onChange,disabled:!r||d,placeholder:"Enter invoice total"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(ee,{message:c}),(0,a.jsx)(y.$,{type:"submit",className:"w-full",disabled:d||!r,children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{className:"mr-2 size-4"}),"Upload Invoice"]})})]})})}function ec(e){let{form:t,documentType:s,selectedPdf:n,onSubmit:l,errorMessage:r}=e,{isActionLoading:o}=(0,u.P)();return(0,a.jsx)(A.lV,{...t,children:(0,a.jsxs)("form",{onSubmit:t.handleSubmit(l),className:"space-y-4",children:[(0,a.jsx)(A.zB,{control:t.control,name:"date",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Document Date"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(K,{date:t.value,handleDateChange:t.onChange,disabled:!n||o})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(ee,{message:r}),(0,a.jsx)(y.$,{type:"submit",className:"w-full",disabled:o||!n,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{className:"mr-2 size-4"}),"Upload ",s.charAt(0).toUpperCase()+s.slice(1).replace("-"," ")]})})]})})}er.displayName="MoneyInput";var ed=s(7807);function eu(e){let{form:t,selectedPdf:s,onSubmit:n}=e,{isActionLoading:l}=(0,u.P)();return(0,a.jsx)(A.lV,{...t,children:(0,a.jsxs)("form",{className:"space-y-4",children:[(0,a.jsx)(A.zB,{control:t.control,name:"newFileName",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"New File Name"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(j.p,{...t,disabled:!s||l,placeholder:"Enter new file name"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"date",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsxs)(A.lR,{children:["Document Date"," ",(0,a.jsx)("span",{className:"text-muted-foreground",children:"(optional)"})]}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(K,{date:t.value,handleDateChange:t.onChange,disabled:!s||l})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(y.$,{type:"button",onClick:()=>t.handleSubmit(e=>n(e,"rename"))(),className:"w-full",disabled:l||!s,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ed.A,{className:"mr-2 size-4"}),"Rename File"]})})]})})}function em(e){let{form:t,vendors:s,selectedPdf:n,onSubmit:l,errorMessage:r}=e,{isActionLoading:o}=(0,u.P)();return(0,a.jsx)(A.lV,{...t,children:(0,a.jsxs)("form",{onSubmit:t.handleSubmit(l),className:"space-y-4",children:[(0,a.jsx)(A.zB,{control:t.control,name:"vendorId",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Vendor"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(q,{vendors:s,selectedVendor:t.value,setSelectedVendor:t.onChange,disabled:!n||o})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"creditMemoNumber",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Credit Memo Number"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(j.p,{...t,placeholder:"Enter credit memo number",disabled:!n||o})}),(0,a.jsx)(A.Rr,{children:"Please provide the credit memo number if available."}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"creditMemoDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Credit Memo Date"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(K,{date:t.value,handleDateChange:t.onChange,disabled:!n||o})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(ee,{message:r}),(0,a.jsx)(y.$,{type:"submit",className:"w-full",disabled:o||!n,children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{className:"mr-2 size-4"}),"Upload Credit Memo"]})})]})})}function ex(e){let{form:t,vendors:s,vendorsLoading:n,selectedPdf:l,onSubmit:r,errorMessage:o}=e,{isActionLoading:i}=(0,u.P)(),c=s.filter(e=>["4179","4180","4181","4182","4183","4184","4185","4186","4187","4188","4189"].includes(e.id)),d=[{id:"GROCERY",name:"GROCERY"},{id:"BEER",name:"BEER"},{id:"MEAT",name:"MEAT"},{id:"SEAFOOD",name:"SEAFOOD"},{id:"PRODUCE",name:"PRODUCE"},{id:"FLORAL",name:"FLORAL"},{id:"DELI",name:"DELI"},{id:"BAKERY",name:"BAKERY"},{id:"PIZZA",name:"PIZZA"},{id:"CHEESE",name:"CHEESE"},{id:"DAIRY",name:"DAIRY"},{id:"FROZEN",name:"FROZEN"},{id:"SUSHI",name:"SUSHI"},{id:"BAKERY_PRODUCTION",name:"BAKERY PRODUCTION"},{id:"MOZZARELLA_PRODUCTION",name:"MOZZARELLA PRODUCTION"}];return(0,a.jsx)(A.lV,{...t,children:(0,a.jsxs)("form",{onSubmit:t.handleSubmit(r),className:"space-y-4",children:[(0,a.jsx)(A.zB,{control:t.control,name:"storeFrom",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Store From"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(q,{vendors:c,selectedVendor:t.value,setSelectedVendor:t.onChange,disabled:!l||n||i,searchPlaceholder:"Search store...",selectText:"Select store...",categoryLabel:"Store"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"storeTo",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Store To"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(q,{vendors:c,selectedVendor:t.value,setSelectedVendor:t.onChange,disabled:!l||n||i,searchPlaceholder:"Search store...",selectText:"Select store...",categoryLabel:"Store"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"departmentTo",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Department To"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(q,{vendors:d,selectedVendor:t.value,setSelectedVendor:t.onChange,disabled:!l||i,searchPlaceholder:"Search department...",selectText:"Select department...",categoryLabel:"Department"})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(A.zB,{control:t.control,name:"invoiceDate",render:e=>{let{field:t}=e;return(0,a.jsxs)(A.eI,{children:[(0,a.jsx)(A.lR,{children:"Invoice Date"}),(0,a.jsx)(A.MJ,{children:(0,a.jsx)(K,{date:t.value,handleDateChange:t.onChange,disabled:!l||i})}),(0,a.jsx)(A.C5,{})]})}}),(0,a.jsx)(ee,{message:o}),(0,a.jsx)(y.$,{type:"submit",className:"w-full",disabled:i||!l,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{className:"mr-2 size-4"}),"Upload Inter-Store Transfer"]})})]})})}function eh(e){let{documentType:t,setDocumentType:s,invoiceForm:n,creditMemoForm:l,interStoreTransferForm:r,nonInvoiceForm:o,otherForm:i,vendors:c,vendorsLoading:d,selectedPdf:m,onInvoiceSubmit:h,onCreditMemoSubmit:f,onInterStoreTransferSubmit:p,onNonInvoiceSubmit:g,onOtherSubmit:j}=e,{errorMessage:N,isActionLoading:w}=(0,u.P)();return(0,a.jsxs)(v,{className:"h-[calc(100vh-64px-52px-24px)] lg:h-[calc(100vh-64px-24px)]",children:[(0,a.jsxs)("div",{className:"h-[70px] border-b p-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Process Document"})}),(0,a.jsx)("div",{className:"truncate text-xs text-gray-500",children:"Select document type and provide details"})]}),(0,a.jsx)("div",{className:"h-[calc(100vh-64px-52px-24px-70px)] overflow-y-auto p-2 px-3 lg:h-[calc(100vh-64px-24px-70px)]",children:(0,a.jsx)("div",{className:"flex h-full flex-col",children:(0,a.jsx)("div",{className:"flex-1 p-6",children:(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Document Type"}),(0,a.jsxs)(R.l6,{value:t||"",onValueChange:e=>s(e),children:[(0,a.jsx)(R.bq,{className:"w-full max-lg:text-xs max-lg:placeholder:text-xs",children:(0,a.jsx)(R.yv,{placeholder:"Select document type"})}),(0,a.jsx)(R.gC,{children:(0,a.jsxs)(R.s3,{children:[(0,a.jsx)(R.eb,{value:"invoice",children:"Invoice"}),(0,a.jsx)(R.eb,{value:"production-order",children:"Production Order"}),(0,a.jsx)(R.eb,{value:"inter-store-transfer",children:"Inter-Store Transfer"}),(0,a.jsx)(R.eb,{value:"credit-memo",children:"Credit Memo"}),(0,a.jsx)(R.eb,{value:"deposit-slip",children:"Deposit Slip"}),(0,a.jsx)(R.eb,{value:"coversheets",children:"Coversheets"}),(0,a.jsx)(R.eb,{value:"delivery-pick-tickets",children:"Delivery/Pick Tickets"}),(0,a.jsx)(R.eb,{value:"paid-out-receipts",children:"Paid out receipts"}),(0,a.jsx)(R.eb,{value:"house-charge",children:"House Charge Receipts"}),(0,a.jsx)(R.eb,{value:"toast",children:"Toast"}),(0,a.jsx)(R.eb,{value:"other",children:"Custom"})]})})]})]}),"invoice"===t||"production-order"===t?(0,a.jsx)(ei,{form:n,vendors:c,vendorsLoading:d,selectedPdf:m,onSubmit:h,documentType:t,errorMessage:N||""}):"credit-memo"===t?(0,a.jsx)(em,{form:l,vendors:c,vendorsLoading:d,selectedPdf:m,onSubmit:f,errorMessage:N||""}):"inter-store-transfer"===t?(0,a.jsx)(ex,{form:r,vendors:c,vendorsLoading:d,selectedPdf:m,onSubmit:p,errorMessage:N||""}):t&&["deposit-slip","coversheets","delivery-pick-tickets","paid-out-receipts","house-charge","toast","inter-store-transfer"].includes(t)?(0,a.jsx)(ec,{form:o,documentType:t,selectedPdf:m,onSubmit:g,errorMessage:N||""}):t&&"other"===t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eu,{form:i,selectedPdf:m,onSubmit:j}),(0,a.jsx)(ee,{message:N}),(0,a.jsx)(y.$,{type:"button",onClick:()=>j(i.getValues(),"upload"),className:"w-full",disabled:null!=w&&w||!m,children:null!=w&&w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 size-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{className:"mr-2 size-4"}),"Upload to Non-Invoice Folder"]})})]}):(0,a.jsx)("div",{className:"py-8 text-center text-gray-500",children:"Please select a document type to continue"})]})})})})]})}s(934);var ef=s(1649);let ep=async e=>{if(!window.ipc)return{error:!0,message:"Window IPC is not available"};{let t=await window.ipc.renameDocument(e);return t.success?{success:!0,data:{newPath:t.newFilePath,originalPath:t.originalPath}}:{error:!0,message:t.error}}},eg=async e=>{if(!window.ipc)return{success:!1,message:"Window IPC is not available"};{let t=await window.ipc.uploadPdf(e);return t.success?t:{success:!1,message:t.error}}},ev=async e=>{if(!window.ipc)return{success:!1,message:"Window IPC is not available"};{let t=await window.ipc.moveFileToZDrive(e);return t.success?{success:!0,data:t}:{success:!1,message:t.error}}},ej=async e=>{try{let t=await ef.A.delete("http://localhost:5000/delete-file",{data:e,timeout:1e4,headers:{"Content-Type":"application/json"}});return{success:!0,data:t.data}}catch(a){var t,s;let e=(null===(s=a.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||a.message||"Unexpected error occurred";return{error:!0,message:"Delete failed: ".concat(e)}}};var ey=s(1550);function eN(){let[e,t]=(0,n.useState)(!0),[s,x]=(0,n.useState)(""),[h,f]=(0,n.useState)([]),[p,g]=(0,n.useState)(!0),[v,j]=(0,n.useState)(null),{storeId:N,date:w,activeTab:b,selectedPdf:P,setSelectedPdf:S,setDirectoryExists:D,directoryPaths:F,setPdfFiles:T,setDeletingPdf:E,setErrorMessage:R,setIsActionLoading:I}=(0,u.P)(),A=(0,l.mN)({resolver:(0,r.u)(m.Uc),defaultValues:{filePath:"",vendorId:"",invoiceNumber:"",invoiceDate:(0,o.f)(new Date,0),documentType:"invoice",invoiceTotal:0}}),_=(0,l.mN)({resolver:(0,r.u)(m.rN),defaultValues:{filePath:"",vendorId:"",creditMemoNumber:"",creditMemoDate:(0,o.f)(new Date,0),documentType:"credit-memo"}}),L=(0,l.mN)({resolver:(0,r.u)(m.W9),defaultValues:{filePath:"",storeFrom:"",storeTo:"",departmentTo:"",invoiceDate:(0,o.f)(new Date,0),documentType:"inter-store-transfer"}}),k=(0,l.mN)({resolver:(0,r.u)(m.YP),defaultValues:{filePath:"",date:(0,o.f)(new Date,0),documentType:"deposit-slip"}}),M=(0,l.mN)({resolver:(0,r.u)(m.UE),defaultValues:{filePath:"",newFileName:"",documentType:"other"}}),O=(0,n.useCallback)(async(e,s)=>{if(console.log("fetchPdfFiles",e,s),!s){console.log("directoryPath is empty"),D(t=>({...t,[e]:!1})),S(null),T([]),t(!1);return}try{if(t(!0),console.log("directoryPath:",s),window.ipc){let t=await window.ipc.getPdfFiles(s);if(t.success){var a;D(s=>({...s,[e]:t.folderExists}));let s=(null==t?void 0:null===(a=t.files)||void 0===a?void 0:a.map(e=>({originalPath:e.path,httpPath:e.path})))||[];T(s),0===s.length?S(null):S(s[0])}else d.oR.error("Failed to fetch PDFs"),D(s=>({...s,[e]:t.folderExists}))}}catch(t){console.log("Error fetching ".concat(e," files:"),t),T([])}finally{t(!1)}},[D,S,T]);(0,n.useEffect)(()=>{P&&(A.setValue("filePath",P.originalPath),k.setValue("filePath",P.originalPath),M.setValue("filePath",P.originalPath))},[P,A,k]),(0,n.useEffect)(()=>{v&&"invoice"!==v&&k.setValue("documentType",v)},[v,k]),(0,n.useEffect)(()=>{(async function(){try{if(g(!0),window.ipc){let e=await window.ipc.getVendors();console.log({vendorData:e}),e&&Array.isArray(e)&&f(e)}}catch(e){console.log("Failed to fetch vendors:",e)}finally{g(!1)}})()},[]),(0,n.useEffect)(()=>{console.log("activeTab changed:",b);let e=F[b];"scans"===b?(console.log("fetching scans in ",e),O("scans",e)):"non-invoice"===b?(console.log("fetching non-invoice in ",e),O("non-invoice",e)):"bills"===b&&F.bills&&(console.log("fetching bills in ",e),O("bills",e))},[b,O,F]);let V=e=>{"bills"===e?O(e,F[e]):"scans"===e?O(e,F[e]):"non-invoice"===e&&O(e,F[e])},B=async e=>{if(console.log({data:e}),R(void 0),!P){console.log("Please select a PDF file");return}try{var t;I(!0);let s=e.invoiceDate.toISOString().split("T")[0],a=e.vendorId,n=e.invoiceNumber,l=null===(t=h.find(e=>e.id===a))||void 0===t?void 0:t.asn_flag,r="".concat(a,"_").concat(n,"_").concat(s).concat(l?"_ASN":"",".pdf"),i=await ep({filePath:P.originalPath,newFileName:r,documentType:v,vendorId:a,invoiceNumber:n,invoiceDate:s});if(i.error)throw Error(i.message);let c={...P,originalPath:i.data.newPath};S(c);let u=await ev({filePath:i.data.newPath,directoryPath:"invoice"===v?F.bills:F["non-invoice"],documentType:v});if(!1===u.success)throw Error(u.message);let m=u.data.newPath;if("invoice"===v){let t=await eg({filePath:m,vendorId:a,invoiceNumber:n,invoiceDate:s,documentType:"invoice",store:N,invoiceTotal:e.invoiceTotal});if(!1===t.success)throw Error(t.message);console.log("uploadResult",t)}await O("scans",F[b]),d.oR.success("Invoice uploaded successfully."),setTimeout(()=>{A.reset({filePath:"",vendorId:"",invoiceNumber:"",invoiceDate:(0,o.f)(new Date,0),documentType:"invoice",invoiceTotal:0}),j(null)},0)}catch(e){console.log("Error in rename and upload process:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the rename and upload process"))}finally{I(!1)}},U=async e=>{if(console.log("handleUploadNonInvoice",e),R(void 0),!P){R("Please select a PDF file");return}try{I(!0),console.log("Processing non-invoice document:",e),console.log("Step 1: Starting file rename...");let t=e.date.toISOString().split("T")[0],s="".concat(e.documentType,"_").concat(t,".pdf"),a=await ep({filePath:P.originalPath,newFileName:s,documentType:e.documentType});if(a.error)throw Error(a.message);let n={...P,originalPath:a.data.newPath};S(n);let l=await ev({filePath:a.data.newPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===l.success)throw Error(l.message);await O("scans",F[b]),d.oR.success("".concat(v," uploaded successfully.")),setTimeout(()=>{k.reset({filePath:"",date:(0,o.f)(new Date,0),documentType:"deposit-slip"}),j(null)},0)}catch(e){console.log("Error in non-invoice processing:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the non-invoice processing"))}finally{I(!1)}},$=async(e,t)=>{if(console.log("handleUploadOther",e,t),R(void 0),!P){R("Please select a PDF file");return}I(!0);try{console.log("handleUploadOther",e,t);let s=e.newFileName;if(e.date){let t=e.date.toISOString().split("T")[0];s="".concat(e.newFileName,"_").concat(t,".pdf")}else s="".concat(e.newFileName,".pdf");if("rename"===t){let t=await ep({filePath:P.originalPath,newFileName:s,documentType:e.documentType});if(t.error)throw Error(t.message)}else if("upload"===t){let t=await ev({filePath:P.originalPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===t.success)throw Error(t.message);setTimeout(()=>{M.reset({filePath:"",newFileName:"",date:void 0,documentType:"other"}),j(null)},0)}await O("scans",F[b]),d.oR.success("Success! ".concat("rename"===t?"Renamed successfully":"Moved to Non-Invoice folder."))}catch(e){R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the other processing"))}finally{I(!1)}},J=async e=>{if(R(void 0),!P){console.log("Please select a PDF file");return}try{I(!0);let t=e.creditMemoDate.toISOString().split("T")[0],s=e.creditMemoNumber,a="".concat(e.vendorId,"_").concat(e.documentType,"_").concat(t,".pdf");s&&(a="".concat(e.vendorId,"_").concat(e.documentType,"_").concat(s,"_").concat(t,".pdf"));let n=await ep({filePath:P.originalPath,newFileName:a,documentType:e.documentType});if(n.error)throw Error(n.message);let l={...P,originalPath:n.data.newPath};S(l);let r=await ev({filePath:n.data.newPath,directoryPath:F.bills,documentType:"credit-memo"});if(!1===r.success)throw Error(r.message);let i=r.data.newPath,c=await eg({filePath:i,vendorId:e.vendorId,invoiceNumber:e.creditMemoNumber||"",invoiceDate:t,documentType:"credit-memo",store:N,invoiceTotal:0});if(!1===c.success)throw Error(c.message);console.log("uploadResult",c),await O("scans",F[b]),d.oR.success("Credit Memo uploaded successfully."),setTimeout(()=>{_.reset({filePath:"",creditMemoNumber:"",creditMemoDate:(0,o.f)(new Date,0),documentType:"credit-memo"})},0)}catch(e){R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the credit memo processing"))}finally{I(!1)}},Y=async e=>{if(R(void 0),!P){R("Please select a PDF file");return}try{I(!0);let t=e.invoiceDate.toISOString().split("T")[0],s="".concat(e.documentType,"_").concat(e.storeFrom,"_").concat(e.storeTo,"-").concat(e.departmentTo,"_").concat(t,".pdf"),a=await ep({filePath:P.originalPath,newFileName:s,documentType:e.documentType});if(a.error)throw Error(a.message);let n={...P,originalPath:a.data.newPath};S(n);let l=await ev({filePath:a.data.newPath,directoryPath:F["non-invoice"],documentType:e.documentType});if(!1===l.success)throw Error(l.message);await O("scans",F[b]),d.oR.success("Inter Store Transfer uploaded successfully."),setTimeout(()=>{L.reset({filePath:"",storeFrom:"",storeTo:"",departmentTo:"",invoiceDate:(0,o.f)(new Date,0),documentType:"inter-store-transfer"})},0)}catch(e){console.log("Error in inter-store transfer processing:",e),R("Error: ".concat(e instanceof Error?e.message:"Failed to complete the inter-store transfer processing"))}finally{I(!1)}},Z=async e=>{E(e);let t=d.oR.loading("Deleting file...");try{let s=await ej({filePath:e});if(s.error){d.oR.error("Failed delete: ".concat(s.message),{id:t});return}s.success&&(d.oR.success("File deleted successfully",{id:t}),(null==P?void 0:P.originalPath)===e&&S(null),await O(b,F[b]))}catch(e){d.oR.error("Delete error: ".concat(e instanceof Error?e.message:"Unknown error"),{id:t})}finally{E(void 0)}};return N?(0,a.jsxs)(ey.cj,{children:[(0,a.jsx)(ey.CG,{asChild:!0,children:(0,a.jsxs)(y.$,{className:"ml-3 mt-3 flex items-center gap-2 capitalize lg:hidden",children:[(0,a.jsx)(c.A,{className:"size-4"})," ","scans"!==b&&w&&"".concat(w.toLocaleDateString()," "),b," Folder"]})}),(0,a.jsxs)(ey.h,{side:"left",children:[(0,a.jsxs)(ey.Fm,{className:"sr-only",children:[(0,a.jsx)(ey.qp,{children:"PDF Files List Sidebar"}),(0,a.jsx)(ey.Qs,{children:"Select a folder to view the files"})]}),(0,a.jsx)(C,{loading:e,filterQuery:s,setFilterQuery:x,onRefresh:V,onDelete:Z})]}),(0,a.jsxs)("div",{className:"grid h-[calc(100vh-64px-52px)] w-screen grid-cols-12 gap-3 p-3 lg:h-[calc(100vh-64px)]",children:[(0,a.jsx)("div",{className:"col-span-3 h-[calc(100vh-64px-52px-24px)] transition-all duration-300 max-lg:hidden lg:h-[calc(100vh-64px-24px)]",children:(0,a.jsx)(C,{loading:e,filterQuery:s,setFilterQuery:x,onRefresh:V,onDelete:Z})}),(0,a.jsx)("div",{className:"lg:col-span-11 ".concat("scans"===b?"col-span-8 lg:col-span-6":"col-span-12 lg:col-span-9"," h-[calc(100vh-64px-52px-24px)] transition-all duration-300 lg:h-[calc(100vh-64px-24px)]"),children:(0,a.jsx)(z,{})}),"scans"===b&&(0,a.jsx)("div",{className:"col-span-4 h-[calc(100vh-64px-52px-24px)] transition-all duration-300 lg:col-span-3 lg:h-[calc(100vh-64px-24px)]",children:(0,a.jsx)(eh,{documentType:v,setDocumentType:j,invoiceForm:A,creditMemoForm:_,interStoreTransferForm:L,nonInvoiceForm:k,otherForm:M,vendors:h,vendorsLoading:p,selectedPdf:P||void 0,onInvoiceSubmit:B,onCreditMemoSubmit:J,onInterStoreTransferSubmit:Y,onNonInvoiceSubmit:U,onOtherSubmit:$},"".concat(v,"-").concat((null==P?void 0:P.originalPath)||"no-pdf"))})]})]}):(0,a.jsx)("div",{className:"flex h-full w-screen items-center justify-center py-20",children:(0,a.jsx)("div",{className:"rounded-lg bg-white p-8 shadow-lg dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-primary mb-4",children:(0,a.jsx)(i.A,{className:"mx-auto size-10"})}),(0,a.jsx)("h2",{className:"text-lg font-medium",children:"Welcome to Bills Utility"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"Select a store to get started"})]})})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[718,4,564,347,239,358],()=>t(4311)),_N_E=e.O()}]);